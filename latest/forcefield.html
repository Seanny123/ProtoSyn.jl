<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Forcefield · ProtoSyn.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="index.html"><img class="logo" src="assets/logo.png" alt="ProtoSyn.jl logo"/></a><h1>ProtoSyn.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li class="current"><a class="toctext" href="forcefield.html">Forcefield</a><ul class="internal"><li><a class="toctext" href="#Components-1">Components</a></li><li><a class="toctext" href="#Evaluators-1">Evaluators</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="forcefield.html">Forcefield</a></li></ul><a class="edit-page" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/master/docs/src/forcefield.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Forcefield</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Force-field-1" href="#Force-field-1">Force-field</a></h1><h2><a class="nav-anchor" id="Components-1" href="#Components-1">Components</a></h2><p>This section provides a description on all the individual components that comprise the Forcefield.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.HarmonicBond" href="#ProtoSyn.Forcefield.HarmonicBond"><code>ProtoSyn.Forcefield.HarmonicBond</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">HarmonicBond(a1::Int64, a2::Int64, k::Float64, b0::Float64)</code></pre><p>Harmonic Bond of the form</p><div>\[E(r_{ab}) = \frac{1}{2}k_{ab}(r_{ab} - b_0)^2\]</div><p>where</p><div>\[r_{ab} = \|\vec{r_{ab}}\| = \|\vec{r_b} - \vec{r_a}\|\]</div><p><strong>Arguments</strong></p><ul><li><code>a1::Int64, a2::Int64</code>: <em>global</em> atom indices.</li><li><code>k::Float64</code>: force constant (kJ mol⁻¹ nm⁻²).</li><li><code>b0::Float64</code>: equilibrium bond length (nm).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.HarmonicBond(1, 2, 2500, 0.19)
Forcefield.HarmonicBond(a1=1, a2=2, k=2500.0, b0=0.19)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L1-L27">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.HarmonicAngle" href="#ProtoSyn.Forcefield.HarmonicAngle"><code>ProtoSyn.Forcefield.HarmonicAngle</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">HarmonicAngle(a1::Int64, a2::Int64, a3::Int64, k::Float64, θ::Float64)</code></pre><p>Harmonic Angle of the form</p><div>\[E(θ_{abc})=\frac{1}{2}k_{abc}(\theta_{abc}-\theta)^{2}\]</div><p><strong>Arguments</strong></p><ul><li><code>a1::Int64, a2::Int64, a3::Int64</code>: <em>global</em> atom indices.</li><li><code>k::Float64</code>: force constant (kJ mol⁻¹ rad⁻²).</li><li><code>θ::Float64</code>: equilibrium angle value (rad).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.HarmonicAngle(1, 2, 3, 670.0, 1.92)
Forcefield.HarmonicAngle(a1=1, a2=2, a3=3, k=670.0, θ=1.92)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L40-L60">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.DihedralCos" href="#ProtoSyn.Forcefield.DihedralCos"><code>ProtoSyn.Forcefield.DihedralCos</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">DihedralCos(a1::Int64, a2::Int64, a3::Int64, a4::Int64, k::Float64, θ::Float64, mult::Float64)</code></pre><p>Periodic Dihedral of the form</p><div>\[E(\phi_{abcd})=K_{\phi}(1+cos(n\phi_{abcd}-\phi))\]</div><p><strong>Arguments</strong></p><ul><li><code>a1::Int64, a2::Int64, a3::Int64, a4::Int64</code>: <em>global</em> atom indices.</li><li><code>k::Float64</code>: force constant (kJ mol⁻¹).</li><li><code>θ::Float64</code>: equilibrium angle value (deg).</li><li><code>mult::Float64</code>: multiplicity.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.DihedralCos(1, 2, 3, 4, 10.46, 180.0, 2.0)
Forcefield.DihedralCos(a1=1, a2=2, a3=3, a4=4, k=10.46, θ=180.0, mult=2.0)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L91-L112">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.Atom" href="#ProtoSyn.Forcefield.Atom"><code>ProtoSyn.Forcefield.Atom</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Atom(name::String, σ::Float64, ϵ::Float64, q::Float64, excls::Array{Int64, 1}, pairs::Array{Int64, 1})</code></pre><p>Define an atom.  σ, ϵ and q describe the non-bonded interactions between atoms:</p><p>The Lennard-Jones interaction is in the form:</p><div>\[E(r_{ab}) = 4ϵ_{ab}\left ( (\frac{σ_{ab}}{r_{ab}})^{12}-(\frac{σ_{ab}}{r_{ab}})^{6}\right )\]</div><p>where the Lorentz-Berthelot rule is applied. σ is the arithmetic average and ϵ is the geometric average:</p><div>\[σ_{ab}=\frac{σ_{a}+σ_{b}}{2}\]</div><div>\[ϵ_{ab}=\sqrt{(ϵ_{a}ϵ_{b})}\]</div><p>For this reason, σ and ϵ are applied here in the reduced form: <span>$\frac{σ}{2}$</span> and <span>$\sqrt{ϵ}$</span>.</p><p>The Coulomb interation is in the form:</p><div>\[E(r_{ab})=k_{ϵ}\frac{q_{a}q_{b}}{r_{ab}^{2}}\]</div><p>where</p><div>\[k_{ϵ}=\frac{1}{4πϵ_{0}}=138.935485\,kJ\,nm\,mol⁻¹\,e⁻¹\]</div><p>For this reason, q is applied here in the reduced form: <span>$q\times \sqrt{k_{ϵ}}$</span></p><p>Exclusion list contains all atom indices who are excluded from non-bonded interactions (i.e. are at 3 or less connections from this atom - includes pairs). Pair list contains atoms that are at 3 connections from this atom, and are involved in 1-4 interactions (and have a different combination rule as a result).</p><p><strong>Arguments</strong></p><ul><li><code>name::String</code>: Atom name (example: &quot;C&quot;, &quot;H&quot;, etc).</li><li><code>σ::Float64</code>: <strong>half the</strong> finite distance at which the inter-particle potential is zero (nm).</li><li><code>ϵ::Float64</code>: <strong>square root</strong> of the depth of the potential well (kJ mol⁻¹).</li><li><code>q::Float64</code>: <strong>adjusted</strong> atom charge (eletron).</li><li><code>excls::Array{Int64, 1}</code>: exclusion list (as <em>global</em> atom indices).</li><li><code>pairs::Array{Int64, 1}</code>: pair list containing atoms that interfere in 1-4 interations (as <em>global</em> atom indices)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.Atom(&quot;N&quot;, 0.325, 0.711, 0.0017, [0, 1, 2, 3, 4, 5], [4, 5])
Forcefield.Atom(name=&quot;N&quot;, σ=0.325, ϵ=0.711, q=0.0017, excls=[0, 1, 2, 3, 4, 5], pairs=[4, 5])</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L128-L176">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.Topology" href="#ProtoSyn.Forcefield.Topology"><code>ProtoSyn.Forcefield.Topology</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">Topology(atoms::Array{Atom}, bonds::Array{HarmonicBond}, angles::Array{HarmonicAngle}, dihedralsCos::Array{DihedralCos})</code></pre><p>Gather all topology components.</p><p><strong>Arguments</strong></p><ul><li><code>atoms::Array{Atoms}</code></li><li><code>bonds::Array{HarmonicBond}</code></li><li><code>angles::Array{HarmonicAngle}</code></li><li><code>dihedralsCos::Array{DihedralCos}</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.Forcefield(atoms, bonds, angles, dihedrals)
Forcefield.Topology(
 atoms=ProtoSyn.Forcefield.Atom[Forcefield.Atom(name=&quot;N&quot;, σ=0.325, ϵ=0.711, q=0.0017, excls=[0, 1, 2, 3, 4, 5], pairs=[4, 5]), ...],
 bonds=ProtoSyn.Forcefield.HarmonicBond[Forcefield.HarmonicBond(a1=1, a2=2, k=2500.0, b0=0.19), ...],
 angles=ProtoSyn.Forcefield.HarmonicAngle[Forcefield.HarmonicAngle(a1=1, a2=2, a3=3, k=670.0, θ=1.92), ...],
 dihedralsCos=ProtoSyn.Forcefield.DihedralCos[Forcefield.DihedralCos(a1=1, a2=2, a3=3, a4=4, k=10.46, θ=180.0, mult=2.0), ...])</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L191-L212">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.Energy" href="#ProtoSyn.Forcefield.Energy"><code>ProtoSyn.Forcefield.Energy</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">DihedralCos(eBond::Float64, eAngle::Float64, eDihedral::Float64, eLJ::Float64, eLJ14::Float64, eCoulomb::Float64, eCoulomb14::Float64, eTotal::Float64)</code></pre><p>Energy components.</p><p><strong>Arguments</strong></p><ul><li><code>a1::Int64, a2::Int64, a3::Int64, a4::Int64</code>: <em>global</em> atom indices.</li><li><code>k::Float64</code>: force constant (kJ mol⁻¹).</li><li><code>θ::Float64</code>: equilibrium angle value (deg).</li><li><code>mult::Float64</code>: multiplicity.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; Forcefield.Energy()
Forcefield.Energy(
 eBond=0.0,
 eAngle=0.0,
 eDihedral=0.0,
 eLJ=0.0,
 eLJ14=0.0,
 eCoulomb=0.0,
 eCoulomb14=0.0,
 eTotal=0.0
)

julia&gt; Forcefield.Energy(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8)
Forcefield.Energy(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/components.jl#L226-L255">source</a></section><h2><a class="nav-anchor" id="Evaluators-1" href="#Evaluators-1">Evaluators</a></h2><p>This section provides a description on how to use the previously documented <a href="#Components-1">Components</a> to calculate their energy.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ProtoSyn.Forcefield.evalbond!" href="#ProtoSyn.Forcefield.evalbond!"><code>ProtoSyn.Forcefield.evalbond!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">evalbond!(bonds::Array{Forcefield.HarmonicBond}, state::Common.State, do_forces::Bool = false) -&gt; Float64</code></pre><p>Evaluate an array of <code>Bonds</code> using the given <strong>state</strong>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/cbcfda19d0c219a3dc78fa5a8312a49dfaf627db/src/Forcefield/evaluators.jl#L1-L6">source</a></section><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
